sklearn.neighbors предоставляет функционал для обучения с учителем и без на основе метода ближайших соседей.

Принцип, лежащий в основе методов ближайших соседей, заключается в том, чтобы найти заранее определенное количество образцов, наиболе близких к расстоянию до новой точки, и на основе этого предсказать "метку" объекта.

В sklearn.neighbors можно работать как с массивами Numpy, так и с scipy.sparse матрицами.

###### Пример нахождения ближайших соседей между двумя наборами данных:
```python
X = np.array([[-1, -1], [-2, -1], [-3, -2], [1, 1], [2, 1], [3, 2]])
nbrs = NearestNeighbors(n_neighbors=2, algorithm='auto').fit(X)
distances, indices = nbrs.kneighbors(X)
```
*где indices - индексы ближайших точек, distances - массив, хранящицй расстояния до точек. *

Также, для нахождения ближайших соседей можно использовать классы KDTree и BallTree.
```python
X = np.array([[-1, -1], [-2, -1], [-3, -2], [1, 1], [2, 1], [3, 2]])
kdt = KDTree(X, leaf_size=30, metric='euclidean') 
kdt.query(X, k=2, return_distance=False)  
blt = BallTree(X, leaf_size=30, metric='euclidean') 
blt.query(X, k=2, return_distance=True)  
```

Классификация методом ближайших соседей
Классификация в данном методе происходит на основе большего числа голосов ближайших соседей каждой точки.
В sсikit-learn реализовано два классификатора ближайших соседей:
KNeighborsClassifier (k - целое, число соседей)
RadiusNeighborsClassifier (r - действительное число, радиус) - в случае неравномерно распределенных данных

##KNeighborsClassifier

KNeighborsClassifier(n_neighbors=5, weights=’uniform’, algorithm=’auto’, leaf_size=30, p=2, metric=’minkowski’, metric_params=None, n_jobs=1)

Параметры: 	
* n_neighbors: целое число, число соседей
* weights: строка или заданная пользователем функция, может принимать след.значения: 
	* uniform - все точки имеют одинаковый вес
	* distance - взвешивает точки путем обратного расстояния. В этом случае более близкие соседи имеют большее влияние, чем точки, расположенные дальше
	* [callable] - ф-я, определенная пользователем, принимающая массив расстояний  и возвращающая массив той же структуры, содержащий веса
* algorithm: {'auto', 'ball_tree', 'kd_tree', 'brute'} - алгоритм, используемый для вычисления ближайших соседей
	* auto - пытается выбрать наиболее подходящий алгоритм, исходя из набора данных, переданного методу fit;
	* ball_tree - использует класс BallTree
	* kd_tree - использует класс KDTree
	* brute - обычный перебор
* leaf_size: целое число. Это значение передается в BallTree или KDTree. Может влиять на скорость построения и запросов, а также на требуемую для хранения дерева память.
* p: целое число. Параметр метрики Минковского. При p = 1 эквивалентно использованию манхэттенского расстояния l1, при p = 2 - евклидового расстояния l2. Для произвольного p используется расстояние Минковского l_p.
* metric: строка или заданная пользователем ф-я.
* metric_params: cловарь. Доп. аргументы для метрики.
* n_jobs: целое число. Число параллельных потоков для поиска соседей. Если = -1, то число потоков = числу ядер процессора. Не влияет на метод fit.

Пример:
```python
>>> X = [[0], [1], [2], [3]]
>>> y = [0, 0, 1, 1]
>>> from sklearn.neighbors import KNeighborsClassifier
>>> neigh = KNeighborsClassifier(n_neighbors=3)
>>> neigh.fit(X, y) 
KNeighborsClassifier(...)
>>> print(neigh.predict([[1.1]]))
[0]
>>> print(neigh.predict_proba([[0.9]]))
[[ 0.66666667  0.33333333]]
```

**Методы**
* fit(X, y)	Устанавливает модель используя обучающие данные X и целевые значения y.
	* X может быть массивом, матрицей, BallTree, KDTree.
* get_params([deep])	Получить параметры для оценки.
	* deep принимает значения true/false. 
* kneighbors([X, n_neighbors, return_distance])	Находит K соседей точки. Возвращает массив *ind* индексов ближайших точек и *dist* расстояний. 
	* X - массив точек.
	* n_neighbors - целое число. Число соседей.
	* return_distance - логическое значение. По-умолчанию True. Если False, не возвращает расстояние.
* kneighbors_graph([X, n_neighbors, mode])	Вычисляет граф k-соседей для точек из X.
	* X - массив точек.
	* n_neighbors - целое число. Число соседей.
	* mode: {‘connectivity’, ‘distance’}. Тип возвращаемой матрицы: ‘connectivity’ вернет матрицу связности с единицами и нулями, ‘distance’ - евклидово расстояние между точками.
* predict(X) - предсказывает метки классов для предоставленных данных.
* predict_proba(X) - возвращает вероятностные оценки для данных X.
* score(X, y[, sample_weight])	Возвращает среднюю точность заданных тестовых данных и меток.
	* X - массив образцов.
	* y - метки для X.
	* sample_weight - массив весов образцов.
* set_params(params) - задает параметры оценки.